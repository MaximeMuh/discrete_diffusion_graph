torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([40, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([40]) sigma_list
torch.Size([40, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([40, 1, 16, 16]) score
torch.Size([40, 16, 16]) score
torch.Size([40, 120]) score
torch.Size([40, 120]) grad_log_noise_vec
torch.Size([40]) sigma_list
Epoch 1/100, Loss: 0.24034685548394918
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/optim/lr_scheduler.py:232: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([40, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([40]) sigma_list
torch.Size([40, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([40, 1, 16, 16]) score
torch.Size([40, 16, 16]) score
torch.Size([40, 120]) score
torch.Size([40, 120]) grad_log_noise_vec
torch.Size([40]) sigma_list
Epoch 2/100, Loss: 0.2264726711437106
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64]) sigma_list
torch.Size([64, 1, 16, 16]) train_adj_b_noisy_matrix
torch.Size([64, 1, 16, 16]) score
torch.Size([64, 16, 16]) score
torch.Size([64, 120]) score
torch.Size([64, 120]) grad_log_noise_vec
torch.Size([64]) sigma_list
Traceback (most recent call last):
  File "/Users/mmuhleth/Desktop/diffusion_graph/train_unet.py", line 82, in <module>
    fit(model, optimizer, dataloader, max_epoch=100, device=device)
  File "/Users/mmuhleth/Desktop/diffusion_graph/train_unet.py", line 59, in fit
    l.backward()
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
Traceback (most recent call last):
  File "/Users/mmuhleth/Desktop/diffusion_graph/train_unet.py", line 82, in <module>
    fit(model, optimizer, dataloader, max_epoch=100, device=device)
  File "/Users/mmuhleth/Desktop/diffusion_graph/train_unet.py", line 59, in fit
    l.backward()
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/_tensor.py", line 521, in backward
    torch.autograd.backward(
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/autograd/__init__.py", line 289, in backward
    _engine_run_backward(
  File "/opt/anaconda3/envs/digress/lib/python3.9/site-packages/torch/autograd/graph.py", line 768, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt