/home/mmuhleth/discrete_diffusion_graph/utils/graphs.py:85: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  loss_matrix = loss_matrix * (1-2*torch.tensor(sigma_list).unsqueeze(-1).unsqueeze(-2).expand(grad_log_q_noise_list.size(0),grad_log_q_noise_list.size(1),grad_log_q_noise_list.size(2)).to(device)+1.0/len(sigma_list))
/home/mmuhleth/miniconda3/envs/py38/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
Epoch 1/2000, Loss: 47.279822289943695
New best model saved with loss: 47.279822289943695
Epoch 2/2000, Loss: 45.403572738170624
New best model saved with loss: 45.403572738170624
Epoch 3/2000, Loss: 45.256442040205
New best model saved with loss: 45.256442040205
Epoch 4/2000, Loss: 45.33960810303688
Epoch 5/2000, Loss: 43.82977023720741
New best model saved with loss: 43.82977023720741
Epoch 6/2000, Loss: 44.60742849111557
Epoch 7/2000, Loss: 45.15508672595024
Epoch 8/2000, Loss: 44.1293029487133
Epoch 9/2000, Loss: 45.465951055288315
Epoch 10/2000, Loss: 44.331156104803085
Epoch 11/2000, Loss: 45.063958555459976
Epoch 12/2000, Loss: 44.82905212044716
Epoch 13/2000, Loss: 45.39797595143318
Epoch 14/2000, Loss: 45.359753996133804
Epoch 15/2000, Loss: 44.519339829683304
Epoch 16/2000, Loss: 44.73536419868469
Epoch 17/2000, Loss: 44.66042274236679
Epoch 18/2000, Loss: 45.450885236263275
Epoch 19/2000, Loss: 44.904218792915344
Epoch 20/2000, Loss: 45.6174718439579
Epoch 21/2000, Loss: 45.34125179052353
Epoch 22/2000, Loss: 44.46925097703934
Epoch 23/2000, Loss: 45.138084441423416
Epoch 24/2000, Loss: 45.04169350862503
Epoch 25/2000, Loss: 44.84441915154457
Epoch 26/2000, Loss: 44.89028424024582
Epoch 27/2000, Loss: 45.38892883062363
Epoch 28/2000, Loss: 45.050763458013535
Epoch 29/2000, Loss: 45.01571571826935
Epoch 30/2000, Loss: 45.17191591858864
Epoch 31/2000, Loss: 44.472205728292465
Epoch 32/2000, Loss: 44.90965881943703
Epoch 33/2000, Loss: 43.87780833244324
Epoch 34/2000, Loss: 44.591472029685974
Epoch 35/2000, Loss: 45.26031243801117
Epoch 36/2000, Loss: 44.69830048084259
Epoch 37/2000, Loss: 45.378163039684296
Epoch 38/2000, Loss: 44.93164211511612
Epoch 39/2000, Loss: 44.58852353692055
Epoch 40/2000, Loss: 44.87617155909538
Epoch 41/2000, Loss: 44.85703819990158
Epoch 42/2000, Loss: 45.319641441106796
Epoch 43/2000, Loss: 44.987573474645615
Epoch 44/2000, Loss: 45.15605694055557
Epoch 45/2000, Loss: 45.21321913599968
Epoch 46/2000, Loss: 44.778519839048386
Epoch 47/2000, Loss: 45.22175666689873
Epoch 48/2000, Loss: 44.71271154284477
Epoch 49/2000, Loss: 44.43778169155121
Epoch 50/2000, Loss: 44.7256096303463
Epoch 51/2000, Loss: 44.95351418852806
Epoch 52/2000, Loss: 45.45697200298309
Epoch 53/2000, Loss: 44.97122436761856
Epoch 54/2000, Loss: 45.29784342646599
Epoch 55/2000, Loss: 44.80092868208885
Epoch 56/2000, Loss: 45.70090734958649
Epoch 57/2000, Loss: 44.904277473688126
Epoch 58/2000, Loss: 44.93752792477608
Epoch 59/2000, Loss: 45.11888965964317
Epoch 60/2000, Loss: 44.650523632764816
Epoch 61/2000, Loss: 44.790343284606934
Epoch 62/2000, Loss: 44.513138234615326
Epoch 63/2000, Loss: 44.90109369158745
Epoch 64/2000, Loss: 44.74715995788574
Epoch 65/2000, Loss: 44.67867434024811
Epoch 66/2000, Loss: 44.98738169670105
Epoch 67/2000, Loss: 45.48214101791382
Epoch 68/2000, Loss: 44.452846109867096
Epoch 69/2000, Loss: 44.969207644462585
Epoch 70/2000, Loss: 44.409393072128296
Epoch 71/2000, Loss: 44.391303330659866
Epoch 72/2000, Loss: 45.32828634977341
Epoch 73/2000, Loss: 45.166361570358276
Epoch 74/2000, Loss: 45.21974137425423
Epoch 75/2000, Loss: 45.45043581724167
Epoch 76/2000, Loss: 44.52206778526306
Epoch 77/2000, Loss: 45.053286761045456
Epoch 78/2000, Loss: 44.91900712251663
Epoch 79/2000, Loss: 45.33433270454407
Epoch 80/2000, Loss: 44.556358605623245
Epoch 81/2000, Loss: 45.69702646136284
Epoch 82/2000, Loss: 44.3604990541935
Epoch 83/2000, Loss: 45.07560741901398
Epoch 84/2000, Loss: 43.98470467329025
Epoch 85/2000, Loss: 44.32094278931618
Epoch 86/2000, Loss: 45.12397348880768
Epoch 87/2000, Loss: 45.17799246311188
Epoch 88/2000, Loss: 45.49032571911812
Epoch 89/2000, Loss: 44.317831218242645
Epoch 90/2000, Loss: 44.986975103616714
Epoch 91/2000, Loss: 44.8875695168972
Epoch 92/2000, Loss: 46.10181620717049
Epoch 93/2000, Loss: 45.09294241666794
Epoch 94/2000, Loss: 45.12498074769974
Epoch 95/2000, Loss: 44.73071967065334
Epoch 96/2000, Loss: 45.04031252861023
Epoch 97/2000, Loss: 44.838206350803375
Epoch 98/2000, Loss: 44.39960062503815
Epoch 99/2000, Loss: 45.69417777657509
Epoch 100/2000, Loss: 45.21001201868057
Epoch 101/2000, Loss: 44.919427275657654
Epoch 102/2000, Loss: 44.736138463020325
Epoch 103/2000, Loss: 44.76856902241707
Epoch 104/2000, Loss: 44.84073808789253
Epoch 105/2000, Loss: 44.21584925055504
Epoch 106/2000, Loss: 45.34758159518242
Epoch 107/2000, Loss: 44.91293403506279
Epoch 108/2000, Loss: 44.996666580438614
Epoch 109/2000, Loss: 45.7719564139843
Epoch 110/2000, Loss: 44.896286725997925
Epoch 111/2000, Loss: 45.228549122810364
Epoch 112/2000, Loss: 45.00985622406006
Epoch 113/2000, Loss: 45.08138623833656
Epoch 114/2000, Loss: 45.537774473428726
Epoch 115/2000, Loss: 45.041088938713074
Epoch 116/2000, Loss: 44.932421922683716
Epoch 117/2000, Loss: 44.484671503305435
Epoch 118/2000, Loss: 44.75321415066719
Epoch 119/2000, Loss: 45.00687575340271
Epoch 120/2000, Loss: 45.21490395069122
Epoch 121/2000, Loss: 44.6542549431324
Epoch 122/2000, Loss: 44.93458595871925
Epoch 123/2000, Loss: 45.27117672562599
Epoch 124/2000, Loss: 44.49415236711502
Epoch 125/2000, Loss: 44.90936741232872
Epoch 126/2000, Loss: 45.185675233602524
Epoch 127/2000, Loss: 44.4684773683548
Epoch 128/2000, Loss: 44.987654119729996
Epoch 129/2000, Loss: 45.290667951107025
Epoch 130/2000, Loss: 44.753684133291245
Epoch 131/2000, Loss: 44.93458190560341
Epoch 132/2000, Loss: 46.01567625999451
Epoch 133/2000, Loss: 44.75070282816887
Epoch 134/2000, Loss: 44.36239677667618
Epoch 135/2000, Loss: 45.72529378533363
Epoch 136/2000, Loss: 44.75308018922806
Epoch 137/2000, Loss: 44.2313756942749
Epoch 138/2000, Loss: 44.7009933590889
Epoch 139/2000, Loss: 44.761804819107056
Epoch 140/2000, Loss: 44.58430099487305
Epoch 141/2000, Loss: 44.90322536230087
Epoch 142/2000, Loss: 45.59016063809395
Epoch 143/2000, Loss: 44.95937153697014
Epoch 144/2000, Loss: 44.68741151690483
Epoch 145/2000, Loss: 44.98141786456108
Epoch 146/2000, Loss: 45.37170633673668
Epoch 147/2000, Loss: 45.20863965153694
Epoch 148/2000, Loss: 44.94085690379143
Epoch 149/2000, Loss: 44.827973425388336
Epoch 150/2000, Loss: 45.58127209544182
Epoch 151/2000, Loss: 45.74090105295181
Epoch 152/2000, Loss: 45.647526144981384
Epoch 153/2000, Loss: 43.89056184887886
Epoch 154/2000, Loss: 45.33181768655777
Epoch 155/2000, Loss: 44.77210783958435
Epoch 156/2000, Loss: 44.6030977666378
Epoch 157/2000, Loss: 44.79058054089546
Epoch 158/2000, Loss: 45.09019377827644
Epoch 159/2000, Loss: 44.853007793426514
Epoch 160/2000, Loss: 45.44410511851311
Epoch 161/2000, Loss: 44.94324707984924
Epoch 162/2000, Loss: 45.513058841228485
Epoch 163/2000, Loss: 44.89148551225662
Epoch 164/2000, Loss: 44.844149857759476
Epoch 165/2000, Loss: 45.28148356080055
Epoch 166/2000, Loss: 46.396894067525864
Epoch 167/2000, Loss: 44.91270685195923
Epoch 168/2000, Loss: 45.16259950399399
Epoch 169/2000, Loss: 45.32554370164871
Epoch 170/2000, Loss: 44.55574142932892
Epoch 171/2000, Loss: 44.82868206501007
Epoch 172/2000, Loss: 44.3337881565094
Epoch 173/2000, Loss: 44.729221791028976
Epoch 174/2000, Loss: 44.92823052406311
Epoch 175/2000, Loss: 44.93416374921799
Epoch 176/2000, Loss: 44.9626242518425
Epoch 177/2000, Loss: 45.38148385286331
Epoch 178/2000, Loss: 45.41303193569183
Epoch 179/2000, Loss: 44.594569861888885
Epoch 180/2000, Loss: 44.63763275742531
Epoch 181/2000, Loss: 46.025802075862885
Epoch 182/2000, Loss: 44.71853095293045
Epoch 183/2000, Loss: 44.977870374917984
Epoch 184/2000, Loss: 44.65355744957924
Epoch 185/2000, Loss: 44.79985424876213
Epoch 186/2000, Loss: 45.07777878642082
Epoch 187/2000, Loss: 44.64751720428467
Epoch 188/2000, Loss: 45.16230836510658
Epoch 189/2000, Loss: 44.82187977433205
Epoch 190/2000, Loss: 45.29664772748947
Epoch 191/2000, Loss: 44.84038743376732
Epoch 192/2000, Loss: 45.6244540810585
Epoch 193/2000, Loss: 44.80914464592934
Epoch 194/2000, Loss: 44.8701491355896
Epoch 195/2000, Loss: 45.402905106544495
Epoch 196/2000, Loss: 45.9160538315773
Epoch 197/2000, Loss: 44.647012144327164
Epoch 198/2000, Loss: 44.51618734002113
Epoch 199/2000, Loss: 44.852992832660675
Epoch 200/2000, Loss: 45.37820667028427
Epoch 201/2000, Loss: 44.76535302400589
Epoch 202/2000, Loss: 45.535243541002274
Epoch 203/2000, Loss: 45.24995517730713
Epoch 204/2000, Loss: 44.88780090212822
Epoch 205/2000, Loss: 44.96340462565422
Epoch 206/2000, Loss: 43.71244576573372
New best model saved with loss: 43.71244576573372
Epoch 207/2000, Loss: 44.84292307496071
Epoch 208/2000, Loss: 44.64322227239609
Epoch 209/2000, Loss: 45.04985451698303
Epoch 210/2000, Loss: 45.2154024541378
Epoch 211/2000, Loss: 45.06839281320572
Epoch 212/2000, Loss: 44.36879563331604
Epoch 213/2000, Loss: 44.67202913761139
Epoch 214/2000, Loss: 45.00301143527031
Epoch 215/2000, Loss: 45.2248991727829
Epoch 216/2000, Loss: 45.11242654919624
Epoch 217/2000, Loss: 45.36589989066124
Epoch 218/2000, Loss: 45.15926915407181
Epoch 219/2000, Loss: 45.17786145210266
Epoch 220/2000, Loss: 44.863379150629044
Epoch 221/2000, Loss: 45.78408721089363
Epoch 222/2000, Loss: 45.316664695739746
Epoch 223/2000, Loss: 45.33808320760727
Epoch 224/2000, Loss: 44.70936727523804
Epoch 225/2000, Loss: 44.728577345609665
Epoch 226/2000, Loss: 44.83031803369522
Epoch 227/2000, Loss: 45.377968817949295
Epoch 228/2000, Loss: 45.063039004802704
Epoch 229/2000, Loss: 45.39397031068802
Epoch 230/2000, Loss: 44.98620471358299
Epoch 231/2000, Loss: 44.47843852639198
Epoch 232/2000, Loss: 44.606825679540634
Epoch 233/2000, Loss: 44.83367162942886
Epoch 234/2000, Loss: 44.7681610584259
Epoch 235/2000, Loss: 44.671042680740356
Epoch 236/2000, Loss: 45.181893199682236
Epoch 237/2000, Loss: 44.96661373972893
Epoch 238/2000, Loss: 45.22100210189819
Epoch 239/2000, Loss: 44.943767070770264
Epoch 240/2000, Loss: 45.11188015341759
Epoch 241/2000, Loss: 44.2938377559185
Epoch 242/2000, Loss: 45.1064091026783
Epoch 243/2000, Loss: 45.3253293633461
Epoch 244/2000, Loss: 44.46948400139809
Epoch 245/2000, Loss: 44.55250811576843
Epoch 246/2000, Loss: 44.702750474214554
Epoch 247/2000, Loss: 45.419336795806885
Epoch 248/2000, Loss: 45.056282103061676
Epoch 249/2000, Loss: 44.662518203258514
Epoch 250/2000, Loss: 44.96310204267502
Epoch 251/2000, Loss: 44.9478797018528
Epoch 252/2000, Loss: 45.10354322195053
Epoch 253/2000, Loss: 45.05290639400482
Epoch 254/2000, Loss: 44.9537467956543
Epoch 255/2000, Loss: 44.841086357831955
Epoch 256/2000, Loss: 45.3068542778492
Epoch 257/2000, Loss: 45.51598387956619
Epoch 258/2000, Loss: 45.271968990564346
Epoch 259/2000, Loss: 45.268041640520096
Epoch 260/2000, Loss: 44.89785200357437
Epoch 261/2000, Loss: 45.640586733818054
Epoch 262/2000, Loss: 45.12464940547943
Epoch 263/2000, Loss: 44.26829555630684
Epoch 264/2000, Loss: 44.33447551727295
Epoch 265/2000, Loss: 45.51868513226509
Epoch 266/2000, Loss: 45.76201504468918
Epoch 267/2000, Loss: 45.6227223277092
Epoch 268/2000, Loss: 44.522321581840515
Epoch 269/2000, Loss: 45.334599792957306
Epoch 270/2000, Loss: 45.35035294294357
Epoch 271/2000, Loss: 43.97986915707588
Epoch 272/2000, Loss: 44.749989837408066
Epoch 273/2000, Loss: 44.66548511385918
Epoch 274/2000, Loss: 44.44090923666954
Epoch 275/2000, Loss: 45.33750596642494
Epoch 276/2000, Loss: 44.519070744514465
Epoch 277/2000, Loss: 45.124115347862244
Epoch 278/2000, Loss: 44.502689093351364
Epoch 279/2000, Loss: 45.0914620757103
Epoch 280/2000, Loss: 44.753531485795975
Epoch 281/2000, Loss: 45.48510208725929
Epoch 282/2000, Loss: 45.025132447481155
Epoch 283/2000, Loss: 44.54934749007225
Epoch 284/2000, Loss: 45.03423568606377
Epoch 285/2000, Loss: 45.69713252782822
Epoch 286/2000, Loss: 44.594607561826706
Epoch 287/2000, Loss: 45.48820820450783
Epoch 288/2000, Loss: 44.83509024977684
Epoch 289/2000, Loss: 45.20903089642525
Epoch 290/2000, Loss: 44.11582437157631
Epoch 291/2000, Loss: 45.103467881679535
Epoch 292/2000, Loss: 44.715583086013794
Epoch 293/2000, Loss: 44.909396439790726
Epoch 294/2000, Loss: 45.24719327688217
Epoch 295/2000, Loss: 44.98055621981621
Epoch 296/2000, Loss: 44.255118668079376
Epoch 297/2000, Loss: 45.43773564696312
Epoch 298/2000, Loss: 45.84721890091896
Epoch 299/2000, Loss: 45.09752693772316
Epoch 300/2000, Loss: 44.984144896268845
Epoch 301/2000, Loss: 44.137755215168
Epoch 302/2000, Loss: 45.48141339421272
Epoch 303/2000, Loss: 45.02264428138733
Epoch 304/2000, Loss: 44.93482729792595
Epoch 305/2000, Loss: 45.333505511283875
Epoch 306/2000, Loss: 44.90287497639656
Epoch 307/2000, Loss: 45.54706221818924
Epoch 308/2000, Loss: 45.08468875288963
Epoch 309/2000, Loss: 44.2562313079834
Epoch 310/2000, Loss: 45.41572269797325
Epoch 311/2000, Loss: 45.666579991579056
Epoch 312/2000, Loss: 44.818392634391785
Epoch 313/2000, Loss: 45.794171422719955
Epoch 314/2000, Loss: 44.95958152413368
Epoch 315/2000, Loss: 44.86863672733307
Epoch 316/2000, Loss: 45.16978508234024
Epoch 317/2000, Loss: 44.671671599149704
Epoch 318/2000, Loss: 45.55922934412956
Epoch 319/2000, Loss: 45.778546154499054
Epoch 320/2000, Loss: 44.92544603347778
Epoch 321/2000, Loss: 44.48235157132149
Epoch 322/2000, Loss: 45.268393248319626
Epoch 323/2000, Loss: 44.63111883401871
Epoch 324/2000, Loss: 44.5966771543026
Epoch 325/2000, Loss: 45.112690687179565
Epoch 326/2000, Loss: 44.66329416632652
Epoch 327/2000, Loss: 45.44692972302437
Epoch 328/2000, Loss: 44.997748285532
Epoch 329/2000, Loss: 45.5839404463768
Epoch 330/2000, Loss: 45.82341805100441
Epoch 331/2000, Loss: 44.51242941617966
Epoch 332/2000, Loss: 44.765035063028336
Epoch 333/2000, Loss: 45.223022639751434
Epoch 334/2000, Loss: 45.80878013372421
Epoch 335/2000, Loss: 45.205989599227905
Epoch 336/2000, Loss: 44.82876032590866
Epoch 337/2000, Loss: 44.72441104054451
Epoch 338/2000, Loss: 45.86577156186104
Epoch 339/2000, Loss: 45.087988287210464
Epoch 340/2000, Loss: 44.639535784721375
Epoch 341/2000, Loss: 45.07548278570175
Epoch 342/2000, Loss: 44.493609607219696
Epoch 343/2000, Loss: 44.22791263461113
Epoch 344/2000, Loss: 45.24158388376236
Epoch 345/2000, Loss: 44.824265480041504
Epoch 346/2000, Loss: 44.87837278842926
Epoch 347/2000, Loss: 45.212530225515366
Epoch 348/2000, Loss: 45.334691405296326
Epoch 349/2000, Loss: 45.12842810153961
