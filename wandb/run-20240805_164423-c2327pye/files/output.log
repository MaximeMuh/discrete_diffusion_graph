torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
/home/mmuhleth/discrete_diffusion_graph/utils/graphs.py:128: UserWarning: To copy construct from a tensor, it is recommended to use sourceTensor.clone().detach() or sourceTensor.clone().detach().requires_grad_(True), rather than torch.tensor(sourceTensor).
  loss_matrix = loss_matrix * (1-2*torch.tensor(sigma_list).unsqueeze(-1).unsqueeze(-2).expand(grad_log_q_noise_list.size(0),grad_log_q_noise_list.size(1),grad_log_q_noise_list.size(2)).to(device)+1.0/len(sigma_list))
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([104, 64, 64])
Epoch 1/1000, Loss: 42.22857081890106
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
/home/mmuhleth/miniconda3/envs/py38/lib/python3.11/site-packages/torch/optim/lr_scheduler.py:156: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.
  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([104, 64, 64])
Epoch 2/1000, Loss: 51.63354682922363
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([104, 64, 64])
Epoch 3/1000, Loss: 55.991249561309814
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([128, 64, 64])
torch.Size([104, 64, 64])
Epoch 4/1000, Loss: 51.99092674255371
torch.Size([128, 64, 64])
Traceback (most recent call last):
  File "/home/mmuhleth/discrete_diffusion_graph/train_unet_adj_neigh.py", line 86, in <module>
    fit(model, optimizer, dataloader, max_epoch=1000, device=device)
  File "/home/mmuhleth/discrete_diffusion_graph/train_unet_adj_neigh.py", line 62, in fit
    train_losses.append(l.detach().cpu().item())
                        ^^^^^^^^^^^^^^^^
KeyboardInterrupt