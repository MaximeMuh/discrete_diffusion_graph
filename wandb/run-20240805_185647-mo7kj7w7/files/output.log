Traceback (most recent call last):
  File "/home/mmuhleth/discrete_diffusion_graph/train_vec.py", line 81, in <module>
    fit(model, optimizer, dataloader, max_epoch=200, device=device)
  File "/home/mmuhleth/discrete_diffusion_graph/train_vec.py", line 50, in fit
    score = torch.tensor(edge_vectors_to_batch(score.cpu(), grid_shape)).to(device)
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/mmuhleth/discrete_diffusion_graph/utils/graphs.py", line 479, in edge_vectors_to_batch
    batch_adj_matrices[:, i, j] = edge_vectors[:, edge_index]
    ~~~~~~~~~~~~~~~~~~^^^^^^^^^
  File "/home/mmuhleth/miniconda3/envs/py38/lib/python3.11/site-packages/torch/_tensor.py", line 1089, in __array__
    return self.numpy().astype(dtype, copy=False)
           ^^^^^^^^^^^^
RuntimeError: Can't call numpy() on Tensor that requires grad. Use tensor.detach().numpy() instead.